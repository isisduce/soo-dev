<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.soo.apps.database.mapper.DatabaseMapper">

	<!-- ==================================================================================================== -->
	<!-- ==================================================================================================== -->

	<select id="selectTableNames" parameterType="HashMap" resultType="string">
SELECT	table_name
FROM	information_schema.tables
WHERE	table_schema = 'public' and table_type = 'BASE TABLE'
	</select>

	<select id="selectColumns" parameterType="HashMap" resultType="com.soo.apps.database.entity.EntityColumn">
SELECT
		table_name		AS tableName
	,	column_name		AS columnName
	,	data_type		AS dataType
	,	is_nullable		AS isNullable
	,	column_default	AS columnDefault
FROM	information_schema.columns
WHERE	table_schema = 'public'
	AND	table_name = #{tableName}
ORDER BY ordinal_position
	</select>

	<!-- ==================================================================================================== -->
	<!-- ==================================================================================================== -->

	<update id="create" parameterType="HashMap">
CREATE TABLE IF NOT EXISTS ${tableName} (
		seq				SERIAL			PRIMARY KEY
	,	table_catalog	VARCHAR(100)	NOT NULL
	,	table_name		VARCHAR(100)	NOT NULL
	,	table_comment	VARCHAR(255)	NOT NULL
	,	created_at		TIMESTAMP 		DEFAULT CURRENT_TIMESTAMP
	,	created_by		VARCHAR(50)		NOT NULL
)
	</update>

	<update id="dropTable" parameterType="HashMap">
DROP TABLE IF EXISTS ${tableName}
	</update>

	<!-- ==================================================================================================== -->
	<!-- ==================================================================================================== -->

</mapper>
